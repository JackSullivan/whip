PREFIX film: <http://cambridgesemantics.com/ontologies/2009/08/Film#>
SELECT ?p (SUM(IF(?prob = 0, 0, MULTIPLY(LOG(?prob,2), -?prob))) AS ?log_prob)
WHERE {
  {
  SELECT ?p ?o  (DIVIDE(COUNT(?o), ?denom) AS ?prob)
  WHERE {
    ?s ?p ?o .
    ?s a film:MoviePerson .
    {
      SELECT ?p (COUNT(?o) AS ?denom)
      WHERE {
        ?s ?p ?o .
        ?s a film:MoviePerson .
      }
      GROUP BY ?p
    }
  }
  GROUP BY ?p ?o ?denom
  }
}
GROUP BY ?p
ORDER BY ?log_prob
